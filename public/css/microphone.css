/* 麦克风按钮样式 */
.microphone-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
    padding: 15px 0;
}

.microphone-button {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
    user-select: none;
    -webkit-user-select: none;
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
    -webkit-user-drag: none;
    -webkit-appearance: none;
    touch-action: manipulation;
    position: relative;
    z-index: 10;
    border: 1px solid rgba(255, 255, 255, 0.3);
    overflow: hidden;
}

/* 只有在准备就绪状态才显示金属质感效果 */
.microphone-button.ready {
    background:
        linear-gradient(135deg, var(--primary-color), var(--secondary-color)),
        radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.6) 0%, transparent 40%),
        radial-gradient(circle at 80% 80%, rgba(0, 0, 0, 0.4) 0%, transparent 40%);
    box-shadow:
        0 15px 40px rgba(102, 126, 234, 0.4),
        0 0 0 0 rgba(102, 126, 234, 0.4),
        inset 0 4px 8px rgba(255, 255, 255, 0.6),
        inset 0 -4px 8px rgba(0, 0, 0, 0.4),
        0 0 20px rgba(102, 126, 234, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.5);
}

/* 只有在准备就绪状态才显示金属纹理效果 */
.microphone-button.ready::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image:
        radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.7) 0%, transparent 60%),
        radial-gradient(circle at 75% 75%, rgba(0, 0, 0, 0.3) 0%, transparent 60%),
        radial-gradient(circle at 50% 10%, rgba(255, 255, 255, 0.35) 0%, transparent 40%),
        repeating-linear-gradient(
            45deg,
            transparent,
            transparent 1px,
            rgba(0, 0, 0, 0.04) 1px,
            rgba(0, 0, 0, 0.04) 3px
        ),
        repeating-linear-gradient(
            -45deg,
            transparent,
            transparent 2px,
            rgba(255, 255, 255, 0.06) 2px,
            rgba(255, 255, 255, 0.06) 4px
        );
    background-size: 100% 100%, 100% 100%, 100% 100%, 6px 6px, 8px 8px;
    border-radius: 50%;
    pointer-events: none;
    z-index: 1;
}

/* 只有在准备就绪状态才显示金属边缘效果 */
.microphone-button.ready::after {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: conic-gradient(
        from 0deg,
        rgba(255, 255, 255, 0.35) 0deg,
        rgba(255, 255, 255, 0.2) 60deg,
        rgba(0, 0, 0, 0.15) 120deg,
        rgba(0, 0, 0, 0.05) 180deg,
        rgba(255, 255, 255, 0.1) 240deg,
        rgba(255, 255, 255, 0.25) 300deg,
        rgba(255, 255, 255, 0.35) 360deg
    );
    border-radius: 50%;
    z-index: 0;
    pointer-events: none;
    opacity: 0.8;
}

/* 基础图标样式 */
.microphone-icon {
    width: 48px;
    height: 48px;
    color: white;
    fill: white;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
    transition: opacity 0.3s ease;
}

/* 初始化时的麦克风按钮状态（包含隐藏图标的按钮） */
.microphone-button:has(.microphone-icon.hidden-initial) {
    cursor: not-allowed;
    /* 使用背景透明而不是整个按钮透明，确保加载图标可见 */
    background: transparent !important;
    pointer-events: none;
    /* 移除所有按钮动效，减少视觉过载 */
    animation: none;
    transform: none;
    box-shadow: none;
}

/* 兼容性备用方案（对于不支持:has()的浏览器） */
.microphone-button.initializing {
    cursor: not-allowed;
    /* 使用背景透明而不是整个按钮透明，确保加载图标可见 */
    background: transparent !important;
    pointer-events: none;
    /* 移除所有按钮动效，减少视觉过载 */
    animation: none;
    transform: none;
    box-shadow: none;
}

/* 金属质感图标效果只在ready状态显示 */
.microphone-button.ready .microphone-icon {
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2)) brightness(0.9);
    position: relative;
    z-index: 2;
}

/* 加载状态的脉冲动画 - 已禁用，按钮在加载时完全透明 */
/*
@keyframes pulse-loading {
    0%, 100% {
        transform: scale(1);
        box-shadow: 
            0 10px 30px rgba(102, 126, 234, 0.3),
            0 0 0 0 rgba(102, 126, 234, 0.4);
    }
    50% {
        transform: scale(1.02);
        box-shadow: 
            0 15px 35px rgba(102, 126, 234, 0.4),
            0 0 0 5px rgba(102, 126, 234, 0.2);
    }
}
*/

.microphone-button:hover {
    transform: translateY(-2px) scale(1.05);
    box-shadow: 
        0 15px 40px rgba(102, 126, 234, 0.4),
        0 0 0 0 rgba(102, 126, 234, 0.4);
}

.microphone-button:active {
    transform: translateY(0) scale(0.98);
}

/* 按钮点击反馈动画 */
.microphone-button.click-feedback {
    animation: button-click-feedback 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

@keyframes button-click-feedback {
    0% {
        transform: scale(1);
        box-shadow: 
            0 10px 30px rgba(102, 126, 234, 0.3),
            0 0 0 0 rgba(102, 126, 234, 0.4);
    }
    50% {
        transform: scale(0.95);
        box-shadow: 
            0 5px 15px rgba(102, 126, 234, 0.6),
            0 0 0 8px rgba(102, 126, 234, 0.15);
    }
    100% {
        transform: scale(1.02);
        box-shadow: 
            0 15px 35px rgba(102, 126, 234, 0.4),
            0 0 0 4px rgba(102, 126, 234, 0.1);
    }
}

.microphone-button.recording {
    animation: pulse-recording 1.5s ease-in-out infinite;
    box-shadow:
        0 15px 45px rgba(59, 130, 246, 0.6),
        0 0 0 15px rgba(59, 130, 246, 0.2),
        0 0 0 30px rgba(59, 130, 246, 0.1),
        inset 0 4px 8px rgba(255, 255, 255, 0.5),
        inset 0 -4px 8px rgba(0, 0, 0, 0.3);
    background:
        linear-gradient(135deg, #3b82f6, #1d4ed8),
        radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.7) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(0, 0, 0, 0.25) 0%, transparent 50%);
    border: 2px solid rgba(255, 255, 255, 0.6);
}

.microphone-button.recording::before {
    background-image:
        radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.9) 0%, transparent 70%),
        radial-gradient(circle at 75% 75%, rgba(0, 0, 0, 0.35) 0%, transparent 70%),
        radial-gradient(circle at 50% 15%, rgba(255, 255, 255, 0.5) 0%, transparent 50%),
        repeating-linear-gradient(
            45deg,
            transparent,
            transparent 1px,
            rgba(0, 0, 0, 0.1) 1px,
            rgba(0, 0, 0, 0.1) 3px
        ),
        repeating-linear-gradient(
            -45deg,
            transparent,
            transparent 2px,
            rgba(255, 255, 255, 0.08) 2px,
            rgba(255, 255, 255, 0.08) 4px
        );
}

.microphone-icon {
    width: 48px;
    height: 48px;
    color: white;
    fill: white;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
    transition: opacity 0.3s ease;
}

/* 初始化时隐藏麦克风图标 */
.microphone-icon.hidden-initial {
    opacity: 0;
    pointer-events: none;
}

/* 显示麦克风图标 */
.microphone-icon.show {
    opacity: 1;
    pointer-events: auto;
}

/* 加载图标样式 */
.loading-icon {
    width: 48px;
    height: 48px;
    color: white;
    fill: white;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
    animation: rotate-loading 1.5s linear infinite;
    transition: opacity 0.3s ease;
    /* 确保图标在按钮中心 */
    position: absolute;
    top: 50%;
    left: 50%;
    /* transform 由动画接管 */
}

/* 隐藏加载图标 */
.loading-icon.hidden {
    opacity: 0;
    pointer-events: none;
}

/* 旋转动画 */
@keyframes rotate-loading {
    from {
        transform: translate(-50%, -50%) rotate(0deg);
    }
    to {
        transform: translate(-50%, -50%) rotate(360deg);
    }
}

.listening-indicator {
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.3s ease;
    color: var(--text-secondary);
    font-size: 0.9rem;
    font-weight: 500;
}

.listening-indicator.active {
    opacity: 1;
    transform: translateY(0);
    color: #3b82f6;
}




.timer {
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-secondary);
    min-width: 60px;
    text-align: center;
}

.timer.recording {
    color: #3b82f6;
    animation: timer-pulse 1s ease-in-out infinite;
}

/* 动画效果 */
@keyframes pulse-recording {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.05);
    }
}

@keyframes timer-pulse {
    0%, 100% {
        opacity: 1;
    }
    50% {
        opacity: 0.7;
    }
}

/* 移动端优化 */
@media (max-width: 768px) {
    .microphone-button {
        width: 100px;
        height: 100px;
    }
    
    .microphone-icon {
        width: 40px;
        height: 40px;
    }
    
    .loading-icon {
        width: 40px;
        height: 40px;
    }
}

@media (max-width: 480px) {
    .microphone-button {
        width: 90px;
        height: 90px;
    }
    
    .microphone-icon {
        width: 36px;
        height: 36px;
    }
    
    .loading-icon {
        width: 36px;
        height: 36px;
    }
    
    .listening-indicator {
        font-size: 0.8rem;
    }
    
    .timer {
        font-size: 1rem;
    }
}

/* 加载状态的跳动点动画和水波效果组合 */
.loading-dots {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    background-color: #FBFCFE;
    border-radius: 50%;
    position: relative;
}

/* 水波效果容器，位于跳动点外面，在麦克风按钮区域 */
.sound-waves_7ree {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 120px;
    height: 120px;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
    z-index: 1; /* 确保水波在跳动点下方 */
}

.sound-waves_7ree.active {
    opacity: 1;
}

.wave_7ree {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    border: 2px solid var(--primary-color);
    border-radius: 50%;
    opacity: 0;
}

.wave_7ree:nth-child(1) {
    width: 130px;
    height: 130px;
    animation: wave-animation_7ree 1.5s ease-out infinite;
    animation-delay: 0s;
}

.wave_7ree:nth-child(2) {
    width: 150px;
    height: 150px;
    animation: wave-animation_7ree 1.5s ease-out infinite;
    animation-delay: 0.3s;
}

.wave_7ree:nth-child(3) {
    width: 170px;
    height: 170px;
    animation: wave-animation_7ree 1.5s ease-out infinite;
    animation-delay: 0.6s;
}

.wave_7ree:nth-child(4) {
    width: 190px;
    height: 190px;
    animation: wave-animation_7ree 1.5s ease-out infinite;
    animation-delay: 0.9s;
}

.wave_7ree:nth-child(5) {
    width: 210px;
    height: 210px;
    animation: wave-animation_7ree 1.5s ease-out infinite;
    animation-delay: 1.2s;
}

@keyframes wave-animation_7ree {
    0% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.92);
    }
    20% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(0.95);
    }
    100% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(1.3);
    }
}

/* 录音时的音波颜色变化 */
.sound-waves_7ree.recording .wave_7ree {
    border-color: #3b82f6;
    box-shadow: 0 0 10px rgba(59, 130, 246, 0.3);
}

.sound-waves_7ree.recording .wave_7ree:nth-child(1) {
    animation: wave-recording_7ree 1.5s ease-out infinite;
    animation-delay: 0s;
}

.sound-waves_7ree.recording .wave_7ree:nth-child(2) {
    animation: wave-recording_7ree 1.5s ease-out infinite;
    animation-delay: 0.3s;
}

.sound-waves_7ree.recording .wave_7ree:nth-child(3) {
    animation: wave-recording_7ree 1.5s ease-out infinite;
    animation-delay: 0.6s;
}

.sound-waves_7ree.recording .wave_7ree:nth-child(4) {
    animation: wave-recording_7ree 1.5s ease-out infinite;
    animation-delay: 0.9s;
}

.sound-waves_7ree.recording .wave_7ree:nth-child(5) {
    animation: wave-recording_7ree 1.5s ease-out infinite;
    animation-delay: 1.2s;
}

@keyframes wave-recording_7ree {
    0% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.92);
        border-color: #3b82f6;
    }
    30% {
        opacity: 0.8;
        transform: translate(-50%, -50%) scale(0.98);
        border-color: #60a5fa;
    }
    60% {
        opacity: 0.6;
        transform: translate(-50%, -50%) scale(1.05);
        border-color: #3b82f6;
    }
    100% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(1.2);
        border-color: #93c5fd;
    }
}

.loading-dot {
    width: 16px;
    height: 16px;
    background-color: #3b82f6; /* 蓝色，与水波纹颜色一致 */
    border-radius: 50%;
    margin: 0 8px;
    animation: bounce 1.5s infinite ease-in-out both;
    z-index: 10; /* 确保跳动点在水波上方 */
    position: relative;
}

.loading-dot:nth-child(1) {
    animation-delay: -0.32s;
}

.loading-dot:nth-child(2) {
    animation-delay: -0.16s;
}

@keyframes bounce {
    0%, 80%, 100% {
        transform: scale(0);
    }
    40% {
        transform: scale(1);
    }
}

/* 麦克风按钮加载状态 */
.microphone-button.loading {
    cursor: not-allowed;
    box-shadow: none;
}

/* 移动端适配 */
@media (max-width: 768px) {
    .loading-dot {
        width: 16px;
        height: 16px;
        margin: 0 8px;
    }
}

@media (max-width: 480px) {
    .loading-dot {
        width: 5px;
        height: 5px;
        margin: 0 2px;
    }
}

/* 移动端水波效果适配 */
@media (max-width: 768px) {
    .sound-waves_7ree {
        width: 90px;
        height: 90px;
    }
    
    .wave_7ree:nth-child(1) { width: 100px; height: 100px; }
    .wave_7ree:nth-child(2) { width: 120px; height: 120px; }
    .wave_7ree:nth-child(3) { width: 140px; height: 140px; }
    .wave_7ree:nth-child(4) { width: 160px; height: 160px; }
    .wave_7ree:nth-child(5) { width: 180px; height: 180px; }
}

@media (max-width: 480px) {
    .sound-waves_7ree {
        width: 90px;
        height: 90px;
    }
    
    .wave_7ree:nth-child(1) { width: 95px; height: 95px; }
    .wave_7ree:nth-child(2) { width: 110px; height: 110px; }
    .wave_7ree:nth-child(3) { width: 125px; height: 125px; }
    .wave_7ree:nth-child(4) { width: 140px; height: 140px; }
    .wave_7ree:nth-child(5) { width: 155px; height: 155px; }
}